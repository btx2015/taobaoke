<include file="Public:header"/>
<link href="__PUBLIC__/Admin/css/plugins/datapicker/datepicker3.css" rel="stylesheet">
<style type="text/css">
        /* Additional style to fix warning dialog position */
    #alertmod_table_list_2 {
        top: 900px !important;
    }
    .ui-jqgrid tr.jqgrow td { white-space: normal !important; height:auto; }
</style>
<body>
<div id="wrapper">
    <include file="Public:menu"/>
    <div id="page-wrapper" class="gray-bg">
        <include file="Public:nav"/>
        <div class="wrapper wrapper-content  animated fadeInRight">
            <div class="row">
                <div class="col-lg-12">
                    <div class="ibox ">
                        <div class="ibox-title">
                            <div class="container-fluid">
                                <form class="form-inline" id="toolbar-form" onsubmit="return false;">
                                    <div class="row">
                                        <div class="form-group">
                                            <input type="text" class="form-control" name="usa"
                                                   placeholder="用户名" style="width: 100px">
                                        </div>
                                        <div class="form-group">
                                            <input type="text" class="form-control" name="name"
                                                   placeholder="姓名" style="width: 100px">
                                        </div>
                                        <div class="form-group">
                                            <input type="text" class="form-control" name="phone"
                                                   placeholder="手机" style="width: 120px">
                                        </div>
                                        <div class="form-group">
                                            <select class="form-control" name="state">
                                                <option value="">请选择状态</option>
                                                <option value="1">启用</option>
                                                <option value="2">禁用</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <input type="text" id="toolbar-datepicker" name="create_from" class="form-control"
                                                   style="width: 180px;" placeholder="创建时间"/>
                                        </div>
                                        <div class="form-group">
                                            <button class="btn btn-sm btn-primary" id="toolbar-reset">重置
                                            </button>
                                        </div>
                                        <div class="form-group">
                                            <button class="btn btn-sm btn-primary" id="toolbar-search">查询
                                            </button>
                                        </div>
                                        <div class="form-group pull-right">
                                            <button class="btn btn-sm btn-success" type="button" data-toggle="modal"  data-target="#myModal4">添加
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <div class="ibox-content">
                            <div class="jqGrid_wrapper">
                                <table id="table"></table>
                                <div id="pager"></div>
                            </div>
                            <div class="modal inmodal" id="myModal4" tabindex="-1" role="dialog"  aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content animated fadeIn">
                                        <div class="modal-header">
                                            <span>添加</span>
                                        </div>
                                        <div class="modal-body">
                                            <form class="form-horizontal">
                                                <div class="form-group">
                                                    <label class="control-label">用户名</label>
                                                    <input type="text" class="form-control" name="usa">
                                                </div>
                                                <div class="form-group">
                                                    <label>姓  名</label>
                                                    <input type="text" class="form-control" name="name">
                                                </div>
                                                <div class="form-group">
                                                    <label>手  机</label>
                                                    <input type="text" class="form-control" name="phone">
                                                </div>
                                                <div class="form-group">
                                                    <select class="form-control" name="state">
                                                        <option value="">请选择状态</option>
                                                        <option value="1">启用</option>
                                                        <option value="2">禁用</option>
                                                    </select>
                                                </div>
                                            </form>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-white" data-dismiss="modal">Close</button>
                                            <button type="button" class="btn btn-primary">Save changes</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <include file="Public:footer"/>
    </div>
</div>
<!-- Mainly scripts -->
<script src="__PUBLIC__/Admin/js/jquery-3.1.1.min.js"></script>
<script src="__PUBLIC__/Admin/js/bootstrap.min.js"></script>
<script src="__PUBLIC__/Admin/js/plugins/metisMenu/jquery.metisMenu.js"></script>
<script src="__PUBLIC__/Admin/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

<!-- Peity -->
<script src="__PUBLIC__/Admin/js/plugins/peity/jquery.peity.min.js"></script>

<!-- jqGrid -->
<script src="__PUBLIC__/Admin/js/plugins/jqGrid/i18n/grid.locale-en.js"></script>
<script src="__PUBLIC__/Admin/js/plugins/jqGrid/jquery.jqGrid.min.js"></script>

<!-- Custom and plugin javascript -->
<script src="__PUBLIC__/Admin/js/inspinia.js"></script>
<script src="__PUBLIC__/Admin/js/plugins/pace/pace.min.js"></script>

<script src="__PUBLIC__/Admin/js/plugins/jquery-ui/jquery-ui.min.js"></script>


<script src="__PUBLIC__/Admin/js/plugins/datapicker/bootstrap-datepicker.js"></script>
<script>
    $(document).ready(function () {
        var url = "{:U('system/user/records')}";
        var height = $(window).height();
        $("#table").jqGrid({
            url:url,
            mtype: 'POST',
            datatype: "json",
            autowidth: true,
            shrinkToFit: true,
            viewrecords: true,
            hidegrid: false,
            height: height - 300,
            rowNum: 15,
            rowList: [15, 30],
            colNames: ['ID','用户名','姓名','手机','角色','状态','登录次数','登录时间','创建时间','操作'],
            colModel: [
                {name: 'id',align:'center',width:60},
                {name: 'usa',align:'center'},
                {name: 'name',align:'center'},
                {name: 'phone',align:'center'},
                {name: 'role_id_str',align:'center'},
                {name: 'state_str',align:'center',width:60},
                {name: 'login_num',align:'center'},
                {name: 'login_time_str',align:'center',width: 170},
                {name: 'created_at_str',align:'center',width: 170},
                {name: 'operate', index: 'operate',width: 170,
                    formatter: function (value, grid, rows, state) {
                        return '<button type="button" class="btn btn-primary btn-xs" onclick="modify(\''+ rows.id+ '\');">编辑</button>'
                            + '<button type="button" class="btn btn-warning btn-xs" onclick="modify(\''+ rows.id+ '\');">禁用</button>'
                            + '<button type="button" class="btn btn-danger btn-xs" onclick="modify(\''+ rows.id+ '\');">删除</button>';
                    }
                }
            ],
            pager: "#pager",
            jsonReader:{
                root:"data.list",
                records:"data.total"
            }
        });
        $(window).bind('resize', function () {
            var width = $('.jqGrid_wrapper').width();
            $('#table').setGridWidth(width);
        });
        $('#toolbar-search').click(function(){
            var postData = $('#toolbar-form').serialize();
            $("#table").jqGrid('setGridParam', {
                url : url,
                datatype:'json',
                postData : postData,
                page : 1
            }).trigger("reloadGrid"); //重新载入
        });
        $('#toolbar-reset').click(function(){
            $('#toolbar-form')[0].reset();
        });
    });
</script>
</body>
</html>